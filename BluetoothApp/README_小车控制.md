# 小车控制功能使用说明

## 概述

本蓝牙App已成功集成小车控制功能，可以通过程序控制小车的运动。基于您提供的硬件代码分析，实现了完整的运动控制和传感器数据监控功能。

## 功能特性

### 1. 运动控制
- **停止** (命令: '0') - 立即停止小车
- **前进** (命令: '1') - 小车向前运动
- **后退** (命令: '2') - 小车向后运动  
- **左转** (命令: '3') - 小车左转90度
- **右转** (命令: '4') - 小车右转90度
- **掉头** (命令: '5') - 小车掉头180度

### 2. 传感器数据监控
- **电机数据**: 实时显示电机A和电机B的RPM
- **MPU6500数据**: 显示加速度计和陀螺仪数据
- **LiDAR数据**: 显示激光雷达的角度、距离和质量信息
- **电池电压**: 显示当前电池电压

### 3. 安全功能
- **紧急停止**: 红色紧急停止按钮，确保安全
- **连接状态监控**: 实时显示与硬件的连接状态
- **数据验证**: 自动验证控制命令的有效性

## 使用方法

### 步骤1: 连接蓝牙
1. 启动蓝牙App
2. 点击"扫描"按钮搜索蓝牙设备
3. 选择您的小车蓝牙设备进行连接
4. 等待连接成功提示

### 步骤2: 打开小车控制界面
1. 连接成功后，点击主界面上的"小车控制"按钮
2. 小车控制界面将弹出，显示控制面板和传感器数据

### 步骤3: 控制小车运动
- 使用方向控制按钮：
  - **停止**: 红色按钮，立即停止小车
  - **前进**: 向上箭头，小车前进
  - **后退**: 向下箭头，小车后退
  - **左转**: 向左箭头，小车左转90度
  - **右转**: 向右箭头，小车右转90度
  - **掉头**: 橙色按钮，小车掉头180度

### 步骤4: 监控传感器数据
- 传感器数据面板实时显示：
  - 电机转速 (RPM)
  - 加速度数据 (X, Y, Z轴)
  - 陀螺仪数据 (X, Y, Z轴)
  - LiDAR数据 (角度、距离、质量)
  - 电池电压

## 技术实现

### 通信协议
基于您的硬件代码，实现了以下通信协议：
- 控制命令通过UART1发送单个字符('0'-'5')
- 传感器数据通过UART1接收，格式包括：
  - 电机数据: "MotorA:XX.X,RPMB:XX.X"
  - MPU6500数据: "AccX:XX.XX,AccY:XX.XX,AccZ:XX.XX,GyroX:XX.XX,GyroY:XX.XX,GyroZ:XX.XX"
  - LiDAR数据: "A:XX.XX,D:XX.XX,Q:XX"

### 核心类说明
1. **RobotController**: 小车控制核心类
   - 处理运动控制命令
   - 解析传感器数据
   - 管理连接状态

2. **RobotControlForm**: 小车控制界面
   - 提供直观的控制按钮
   - 实时显示传感器数据
   - 安全控制功能

3. **Form1**: 主界面集成
   - 蓝牙连接管理
   - 小车控制界面入口
   - 数据日志记录

## 安全注意事项

1. **使用前检查**:
   - 确保小车在安全的环境中
   - 检查电池电量充足
   - 确认蓝牙连接稳定

2. **操作建议**:
   - 先测试停止功能确保响应正常
   - 从小幅度运动开始测试
   - 保持紧急停止按钮随时可用

3. **故障处理**:
   - 如果小车无响应，检查蓝牙连接
   - 如果传感器数据异常，重启硬件
   - 紧急情况下断开蓝牙连接

## 扩展功能

### 可添加的高级功能
1. **路径规划**: 基于LiDAR数据的避障功能
2. **自动导航**: 结合传感器数据的智能导航
3. **数据记录**: 传感器数据的历史记录和分析
4. **远程监控**: 通过网络远程控制小车

### 代码扩展点
- 在`RobotController.cs`中添加新的控制命令
- 在`RobotControlForm.cs`中添加新的UI控件
- 在`Form1.cs`中集成新的功能模块

## 故障排除

### 常见问题
1. **连接失败**: 检查蓝牙设备是否开启，重新扫描
2. **控制无响应**: 检查硬件连接，重启硬件
3. **数据异常**: 检查传感器连接，查看硬件日志
4. **界面卡顿**: 关闭不必要的程序，检查系统资源

### 调试方法
1. 查看主界面的运行日志
2. 检查传感器数据是否正常
3. 使用串口调试工具验证硬件通信
4. 查看Windows事件日志

## 技术支持

如有问题，请检查：
1. 硬件连接是否正常
2. 蓝牙驱动是否最新
3. .NET Framework版本是否兼容
4. 系统权限是否足够

---

**注意**: 本功能基于您提供的硬件代码开发，请确保硬件固件与代码协议匹配。
